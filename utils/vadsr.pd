#N canvas 121 146 967 758 12;
#X obj 108 100 inlet;
#X obj 108 128 sel 0;
#X obj 495 250 inlet;
#X obj 49 634 line~;
#X obj 545 250 inlet;
#X obj 606 250 inlet;
#X obj 693 251 inlet;
#X msg 108 351 stop;
#X obj 49 661 outlet~;
#X text 21 11 ADSR ENVELOPE;
#X text 491 228 attack;
#X text 546 228 decay;
#X text 606 228 sustain;
#X text 690 229 release;
#X obj 218 191 moses, f 9;
#X obj 218 221 t b b;
#X msg 152 449 0;
#X text 21 422 ATTACK:;
#X text 212 73 When you send this patch a positive trigger it schedules a line~ to do an attack and decay \, and if zero \, it starts the release ramp.;
#X text 212 116 Negative triggers cause the output to jump to zero and then attack (instead of attacking from the current location).;
#X text 208 11 Arguments: level \, attack time \, decay time \, sustain level \, release time. A \, D \, and R are in msec and S is in percent. This patch is used as an abstraction in various examples.;
#X text 322 454 multiply by peak level and pack with decay time, f 24;
#X text 363 394 on attack \, set a delay for sustain, f 17;
#X text 29 514 then recall peak level and pack with attack time and send to line~, f 31;
#X text 407 493 send to line~;
#X text 727 312 send to line~;
#X text 98 631 generate envelope;
#X text 28 86 if zero \, release and cancel decay, f 10;
#X obj 646 312 s \$0-line;
#X obj 49 601 r \$0-line;
#X text 729 284 on release \, ramp back to zero;
#X obj 502 525 s \$0-line;
#X obj 190 488 s \$0-line;
#X text 306 190 test for negative trigger: if so \, zero the output. in any case \, initialize envelope, f 16;
#X text 21 449 bash to zero (with negative input), f 17;
#X text 651 11 Objects such as "f" and "pack" can be given dollar sign arguments to initialize their contents from adsr's creation arguments. Inlets are supplied to change them on the fly., f 32;
#X text 706 108 adapted by angelfaraldo for ilustrative purposes., f 24;
#X text 121 602 get attack/decay/release line values, f 32;
#X obj 502 455 * 0, f 15;
#X obj 190 448 pack f \$1;
#X obj 646 285 pack 0 \$4;
#X obj 502 425 f \$3, f 18;
#X obj 502 494 pack f \$2;
#X obj 502 395 del \$1;
#X text 108 41 trigger and peak level, f 10;
#X obj 190 423 f 1;
#X obj 262 267 t f b;
#X connect 0 0 1 0;
#X connect 1 0 7 0;
#X connect 1 0 40 0 48.................U.....N...PE....fC...TA...fFB...U....ng...Ph....;
#X connect 1 1 38 1 48.................K....PW...vB....zE...r.....yA...K....vb...vLA...;
#X connect 1 1 14 0 32.................K....vE...vB....bA...rB....;
#X connect 2 0 39 1;
#X connect 2 0 43 1;
#X connect 3 0 8 0;
#X connect 4 0 42 1;
#X connect 5 0 41 1;
#X connect 6 0 40 1;
#X connect 7 0 43 0 32.................L....nX....C....JF...fA....;
#X connect 14 0 15 0;
#X connect 14 1 46 0;
#X connect 15 0 46 0;
#X connect 15 1 16 0;
#X connect 16 0 32 0;
#X connect 29 0 3 0;
#X connect 38 0 42 0;
#X connect 39 0 32 0;
#X connect 40 0 28 0;
#X connect 41 0 38 0;
#X connect 42 0 31 0;
#X connect 43 0 41 0;
#X connect 45 0 39 0;
#X connect 46 0 45 0;
#X connect 46 1 43 0 32.................XA...LN....V....iC...vF....;
