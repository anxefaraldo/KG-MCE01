#N canvas 27 511 760 450 12;
#N canvas 874 48 1046 1004 things 0;
#N canvas 51 96 501 328 fft 0;
#X obj 44 72 inlet~;
#X obj 44 100 rfft~;
#X obj 44 133 *~;
#X obj 75 133 *~;
#X obj 44 163 sqrt~;
#X obj 347 117 block~ 4096 1;
#X obj 44 189 biquad~ 0 0 0 0 1;
#X text 108 101 Fourier series;
#X text 113 154 magnitude;
#X text 111 139 calculate;
#X text 36 11 This subpatch computes the spectrum of the incoming signal with a (rectangular windowed) FFT. FFTs aren't properly introduced until much later.;
#X text 108 71 signal to analyze;
#X text 178 175 delay two samples;
#X text 177 191 for better graphing;
#X obj 44 275 tabwrite~ spectrum;
#X obj 64 247 metro 500;
#X obj 64 220 loadbang;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 0 2 1;
#X connect 1 1 3 0;
#X connect 1 1 3 1;
#X connect 2 0 4 0;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 6 0 14 0;
#X connect 15 0 14 0;
#X connect 16 0 15 0;
#X restore 14 253 pd fft;
#X obj 450 9 loadbang;
#X msg 459 33 \; pd dsp 1;
#X obj 576 168 s waveform;
#X obj 576 112 pack 0 0 0 0 0 0 0, f 46;
#X obj 865 41 t b f;
#X obj 816 42 t b f;
#X obj 766 42 t b f;
#X obj 716 42 t b f;
#X obj 666 42 t b f;
#X obj 616 42 t b f;
#X obj 865 16 r h7;
#X obj 816 17 r h6;
#X obj 766 17 r h5;
#X obj 716 17 r h4;
#X obj 666 17 r h3;
#X obj 616 17 r h2;
#X obj 576 17 r h1;
#X msg 576 140 sinesum 256 \$1 \$2 \$3 \$4 \$5 \$6 \$7 \, normalize;
#X obj 14 227 tabosc4~ waveform;
#X obj 14 117 samplerate~;
#X obj 14 94 bng 18 250 50 0 empty empty empty 0 -6 0 8 #fcfcfc #000000 #000000;
#X floatatom 24 164 0 0 0 0 - - - 0;
#X obj 14 70 loadbang;
#X text 12 11 At load time \, calculate a good choice of fundamental frequency for showing spectra: the 16th bin in a 4096-point spectrum \, so SR*16/4096 or SR/256.;
#X floatatom 145 166 5 0 0 0 - - - 0;
#X obj 145 142 / 4096;
#X text 147 116 One bin is SR/4096:;
#X obj 145 188 s freq-step;
#X obj 14 140 / 256;
#X obj 47 613 cnv 15 100 60 empty empty empty 20 12 0 14 #e0e0e0 #404040 0;
#X obj 56 645 /;
#X msg 56 618 1 \$1;
#X text 63 713 amplitude = 1/h;
#X text 62 678 SAWTOOTH;
#X text 63 695 even and odd harmonics;
#X obj 244 618 cnv 15 100 130 empty empty empty 20 12 0 14 #e0e0e0 #404040 0;
#X obj 251 720 /;
#X msg 251 695 1 \$1;
#X text 246 752 SQUARE;
#X text 246 771 only odd harmonics;
#X obj 283 647 mod 2;
#X obj 251 620 t f f;
#X obj 251 671 *, f 5;
#X text 245 790 amplitude = odd(1/h);
#X text 449 884 TRIANGLE;
#N canvas 542 108 258 432 create-waveform 0;
#X obj 29 372 send waveform;
#X obj 87 31 t l;
#X obj 29 113 list length;
#X obj 29 184 list, f 13;
#X obj 29 90 t l l, f 13;
#X obj 29 137 ==, f 21;
#X obj 29 160 sel 1;
#X obj 29 290 list trim;
#X obj 29 61 list prepend;
#X obj 29 266 list append, f 16;
#X obj 29 208 t b l, f 16;
#X obj 29 22 inlet;
#X obj 141 48 t b f;
#X obj 141 21 receive nh;
#X msg 29 238 sinesum 256;
#X msg 29 341 normalize;
#X obj 29 315 t b a;
#X connect 1 0 8 1;
#X connect 2 0 5 0;
#X connect 3 0 10 0;
#X connect 4 0 2 0;
#X connect 4 1 3 1;
#X connect 5 0 6 0;
#X connect 6 0 3 0;
#X connect 7 0 16 0;
#X connect 8 0 1 0;
#X connect 8 0 4 0;
#X connect 9 0 7 0;
#X connect 10 0 14 0;
#X connect 10 1 9 1;
#X connect 11 0 8 0;
#X connect 12 0 8 1;
#X connect 12 1 5 1;
#X connect 13 0 12 0;
#X connect 14 0 9 0;
#X connect 15 0 0 0;
#X connect 16 0 15 0;
#X connect 16 1 0 0;
#X restore 56 920 pd create-waveform;
#X text 448 903 amplitude = odd(1/hn^2);
#X obj 420 621 cnv 15 150 260 empty empty empty 20 12 0 14 #e0e0e0 #404040 0;
#X obj 428 778 /;
#X msg 428 753 1 \$1;
#X obj 457 648 mod 2;
#X obj 425 674 *, f 5;
#X obj 428 728 *;
#X obj 425 624 t f f;
#X obj 425 702 t f f f;
#X obj 480 742 mod 4;
#X obj 481 768 == 1;
#X obj 450 850 * -1;
#X obj 481 792 sel 1 0;
#X msg 477 817 -1;
#X msg 517 817 1;
#X text 448 922 only odd harmonics \, with phase shift;
#X obj 207 464 symbol;
#X msg 56 435 20;
#N canvas 0 25 279 304 number-of-harmonics 0;
#X obj 48 95 until;
#X msg 66 142 1;
#X obj 49 70 t f b f, f 18;
#X obj 48 168 f 1;
#X obj 89 167 + 1;
#X obj 49 13 inlet;
#X obj 48 200 outlet;
#X obj 172 200 send nh;
#X obj 49 43 f;
#X obj 174 12 inlet;
#X connect 0 0 3 0;
#X connect 1 0 3 1;
#X connect 2 0 0 0;
#X connect 2 1 1 0;
#X connect 2 2 7 0;
#X connect 3 0 4 0;
#X connect 3 0 6 0;
#X connect 4 0 3 1;
#X connect 5 0 8 0;
#X connect 8 0 2 0;
#X connect 9 0 8 0;
#X restore 56 512 pd number-of-harmonics;
#X floatatom 56 461 5 0 0 0 - - - 0;
#X obj 56 409 loadbang;
#X obj 56 536 pack f s, f 26;
#X msg 56 560 \$2 \$1;
#X obj 207 487 t b s;
#X msg 754 410 \; waveform read clarinet.txt \; waveform normalize;
#X msg 620 471 \; waveform read violin.txt \; waveform normalize;
#X obj 66 485 r n_harmonics;
#X msg 209 375 saw;
#X msg 238 396 square;
#X msg 297 425 triang;
#X obj 754 386 r cl;
#X obj 620 446 r vln;
#X obj 209 348 r saw;
#X obj 258 369 r square;
#X obj 322 375 r triang;
#X obj 56 585 route saw square triang, f 80;
#X obj 429 389 tabosc4~ waveform;
#X obj 419 458 dac~;
#X obj 429 363 mtof;
#X obj 429 255 loadbang;
#X msg 429 279 48;
#X floatatom 429 342 5 0 0 0 - - - 0;
#X obj 566 388 line~;
#X msg 566 363 \$1 100;
#X obj 429 424 *~, f 20;
#X obj 571 338 r vol;
#X obj 435 311 r note;
#X floatatom 527 283 5 0 0 0 - - - 0;
#X floatatom 493 342 5 0 0 0 - - - 0;
#X connect 1 0 2 0;
#X connect 4 0 18 0;
#X connect 5 0 4 0;
#X connect 5 1 4 6;
#X connect 6 0 4 0;
#X connect 6 1 4 5;
#X connect 7 0 4 0;
#X connect 7 1 4 4;
#X connect 8 0 4 0;
#X connect 8 1 4 3;
#X connect 9 0 4 0;
#X connect 9 1 4 2;
#X connect 10 0 4 0;
#X connect 10 1 4 1;
#X connect 11 0 5 0;
#X connect 12 0 6 0;
#X connect 13 0 7 0;
#X connect 14 0 8 0;
#X connect 15 0 9 0;
#X connect 16 0 10 0;
#X connect 17 0 4 0;
#X connect 18 0 3 0;
#X connect 19 0 0 0;
#X connect 20 0 26 0;
#X connect 20 0 29 0;
#X connect 21 0 20 0;
#X connect 23 0 21 0;
#X connect 25 0 28 0;
#X connect 26 0 25 0;
#X connect 29 0 22 0;
#X connect 29 0 19 0;
#X connect 31 0 46 0;
#X connect 32 0 31 0;
#X connect 37 0 46 0;
#X connect 38 0 37 0;
#X connect 41 0 43 1;
#X connect 42 0 43 0;
#X connect 42 1 41 0;
#X connect 43 0 38 0;
#X connect 49 0 58 0;
#X connect 50 0 49 0;
#X connect 51 0 52 1;
#X connect 52 0 55 0;
#X connect 53 0 50 0;
#X connect 54 0 52 0;
#X connect 54 1 51 0;
#X connect 55 0 53 0;
#X connect 55 1 53 1;
#X connect 55 2 56 0;
#X connect 56 0 57 0;
#X connect 57 0 59 0;
#X connect 58 0 46 0;
#X connect 59 0 60 0;
#X connect 59 1 61 0;
#X connect 60 0 58 1;
#X connect 61 0 58 1;
#X connect 63 0 70 0;
#X connect 64 0 66 0;
#X connect 65 0 68 0;
#X connect 66 0 65 0;
#X connect 67 0 64 0;
#X connect 68 0 69 0;
#X connect 69 0 82 0;
#X connect 70 0 65 1;
#X connect 70 1 68 1;
#X connect 73 0 65 0;
#X connect 74 0 63 0;
#X connect 75 0 63 0;
#X connect 76 0 63 0;
#X connect 77 0 71 0;
#X connect 78 0 72 0;
#X connect 79 0 74 0;
#X connect 80 0 75 0;
#X connect 81 0 76 0;
#X connect 82 0 32 0;
#X connect 82 1 42 0;
#X connect 82 2 54 0;
#X connect 83 0 91 0;
#X connect 85 0 83 0;
#X connect 86 0 87 0;
#X connect 87 0 88 0;
#X connect 88 0 85 0;
#X connect 89 0 91 1;
#X connect 90 0 89 0;
#X connect 91 0 84 0;
#X connect 91 0 84 1;
#X connect 92 0 90 0;
#X connect 93 0 88 0;
#X connect 95 0 83 0;
#X restore 249 98 pd things;
#X obj 15 284 partial 7;
#X obj 15 239 partial 6;
#X obj 15 193 partial 5;
#X obj 15 149 partial 4;
#X obj 15 103 partial 3;
#X obj 15 56 partial 2;
#X obj 15 11 partial 1;
#X obj 23 357 hsl 144 32 0 1 0 0 vol empty volume -2 -12 0 18 #ffffff #111111 #ffffff 0 1;
#X obj 389 360 bng 70 250 50 0 saw empty saw 15 35 0 23 #ffffff #ffffff #111111;
#X obj 469 360 bng 70 250 50 0 square empty sqr 20 35 0 24 #ffffff #ffffff #111111;
#X obj 549 360 bng 70 250 50 0 triang empty trg 22 35 0 24 #ffffff #ffffff #111111;
#X obj 195 359 bng 70 250 50 0 cl empty cl 28 35 0 24 #ffffff #ffffff #111111;
#X obj 275 359 bng 70 250 50 0 vln empty vln 20 35 0 24 #ffffff #ffffff #111111;
#X obj 26 407 nbx 3 30 1 100 0 0 n_harmonics empty harmonics 68 15 0 17 #ffffff #000000 #ffffff 0 256;
#N canvas 0 23 450 278 (subpatch) 0;
#X array waveform 259 float 1;
#A 0 -0.0307811 0.0416451 0.131143 0.22672 0.311045 0.398215 0.476721 0.535307 0.572944 0.582903 0.561951 0.51371 0.438308 0.349457 0.270822 0.208355 0.167874 0.147569 0.150414 0.182359 0.2306 0.273668 0.312338 0.352043 0.39537 0.434172 0.462494 0.483188 0.501293 0.50776 0.491206 0.444775 0.372995 0.288412 0.200983 0.106441 0.0153906 -0.0579411 -0.0967406 -0.106441 -0.106182 -0.101138 -0.0887223 -0.0711331 -0.0549665 -0.0470771 -0.0397051 -0.0270305 -0.00504399 0.0214692 0.0535438 0.091697 0.129203 0.151449 0.145629 0.109027 0.0487583 -0.0364718 -0.146016 -0.268365 -0.385023 -0.482023 -0.561044 -0.621053 -0.658822 -0.665416 -0.648346 -0.614976 -0.572685 -0.516037 -0.443999 -0.36226 -0.274573 -0.181454 -0.08717 0.00646663 0.0942834 0.175634 0.249095 0.310786 0.362519 0.40106 0.420978 0.423694 0.413088 0.395887 0.375452 0.35269 0.334454 0.332256 0.345835 0.371184 0.398344 0.434816 0.475038 0.517719 0.556518 0.59118 0.626618 0.661534 0.690637 0.714433 0.741077 0.77134 0.804837 0.829926 0.842212 0.848421 0.845187 0.827082 0.79061 0.752329 0.71909 0.690247 0.661924 0.628038 0.595189 0.556649 0.508925 0.439083 0.353337 0.261252 0.171495 0.0869114 0.0047853 -0.0704864 -0.128944 -0.170072 -0.196715 -0.20732 -0.196715 -0.171883 -0.139291 -0.112131 -0.0954476 -0.0845835 -0.0759182 -0.066865 -0.0623384 -0.0702274 -0.0880756 -0.107217 -0.118339 -0.129591 -0.149638 -0.184687 -0.222969 -0.247155 -0.259053 -0.2694 -0.285049 -0.303932 -0.314666 -0.320098 -0.333161 -0.355147 -0.373642 -0.377134 -0.370538 -0.359415 -0.350233 -0.332256 -0.295784 -0.243275 -0.194516 -0.153647 -0.118469 -0.0812207 -0.0451369 -0.0102173 0.0218572 0.0490172 0.0730728 0.0935074 0.110967 0.128169 0.138257 0.141749 0.145758 0.158174 0.179255 0.206674 0.236161 0.268882 0.300439 0.325013 0.328634 0.313244 0.284144 0.248319 0.205768 0.157656 0.106829 0.0622092 0.0269012 -0.000775994 -0.0253492 -0.0530263 -0.0809622 -0.103854 -0.112261 -0.106829 -0.0867822 -0.053673 -0.00142266 0.0638904 0.132178 0.186627 0.214563 0.213657 0.171753 0.09299 -0.0148732 -0.12972 -0.2306 -0.294232 -0.313502 -0.299017 -0.266037 -0.229824 -0.195163 -0.172659 -0.176022 -0.215339 -0.283368 -0.365235 -0.446068 -0.525737 -0.605665 -0.677185 -0.734868 -0.777159 -0.810529 -0.841309 -0.866915 -0.883473 -0.897437 -0.91063 -0.927446 -0.943999 -0.960036 -0.974648 -0.989914 -0.999224 -1 -0.996249 -0.978141 -0.935206 -0.866012 -0.769658 -0.65494 -0.521728 -0.379074 -0.243145 -0.121185 -0.0307811 0.0416451 0.131143 0.131143;
#X coords 0 1 258 -1 200 133 1 0 0;
#X restore 192 152 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array spectrum 128 float 0;
#X coords 0 4300 127 -40 257 133 1 0 0;
#X restore 412 112 graph;
#X text 442 250 1;
#X text 476 250 2;
#X text 508 250 3;
#X text 540 250 4;
#X text 573 250 5;
#X text 603 250 6;
#X text 634 250 7;
#X text 410 250 0;
#X obj 193 97 s note;
#X obj 193 10 else/keyboard 17 80 4 3 0 0 empty empty;
#X text 413 275 harmonic number ------------------------;
#X connect 26 0 25 0;
